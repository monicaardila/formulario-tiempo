<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Formulario Distribución de Tiempo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }

    h2 {
      text-align: center;
      color: #4285f4;
    }

    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin: 8px 0;
      box-sizing: border-box;
    }

    button {
      background-color: #4285f4;
      color: white;
      padding: 10px;
      border: none;
      width: 100%;
      font-size: 16px;
    }

    .radio-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
    }

    .radio-group label {
      width: 48%;
    }
  </style>
</head>
<body>
  <h2>Formulario de Distribución de Tiempo</h2>
  <form id="formulario">
    <label>Nombre:</label>
    <input type="text" name="nombre" required>

    <label>Proceso/Área:</label>
    <input type="text" name="proceso" required>

    <label>Cédula:</label>
    <input type="text" name="cedula" required>

    <label>Cargo:</label>
    <input type="text" name="cargo" required>

    <label>Agencia:</label>
    <input type="text" name="agencia" required>

    <!-- Campos de porcentaje -->
    <label>Otorgamiento Crédito (%):</label>
    <input type="number" name="otorgamiento" min="0" max="100" required>

    <label>Seguimiento Cartera (%):</label>
    <input type="number" name="seguimiento" min="0" max="100" required>

    <label>Cobranza (%):</label>
    <input type="number" name="cobranza" min="0" max="100" required>

    <label>Captaciones (%):</label>
    <input type="number" name="captaciones" min="0" max="100" required>

    <label>Aportes (%):</label>
    <input type="number" name="aportes" min="0" max="100" required>

    <label>Labores Administrativas (%):</label>
    <input type="number" name="administrativas" min="0" max="100" required>

    <label>Procesos Específicos (Descripción):</label>
    <input type="text" id="procesos_especificos" name="procesos_especificos" placeholder="Especifica otras tareas si aplica">

    <label>Procesos Específicos (%):</label>
    <input type="number" name="porcentaje_especificos" min="0" max="100">

    <label>Total (%):</label>
    <input type="number" name="total_porcentaje" id="total_porcentaje" readonly>

    <button type="submit">Enviar</button>
  </form>

  <script>
    document.getElementById("formulario").addEventListener("submit", function (e) {
      e.preventDefault();

      const form = e.target;
      const total =
        Number(form.otorgamiento.value) +
        Number(form.seguimiento.value) +
        Number(form.cobranza.value) +
        Number(form.captaciones.value) +
        Number(form.aportes.value) +
        Number(form.administrativas.value) +
        Number(form.porcentaje_especificos.value || 0);

      if (total > 100) {
        alert("⚠️ La suma de los porcentajes no puede superar el 100%. Actualmente suma: " + total + "%");
        return;
      }

      document.getElementById("total_porcentaje").value = total;

      const formData = new FormData(form);
      formData.append("procesos_especificos", document.getElementById("procesos_especificos").value);
      formData.append("total_porcentaje", total);

      fetch("https://script.google.com/macros/s/AKfycbwAiiRsTfNg5ebUPNkWuG9PvoiW0fUKP3JPaV45JbjJULcMwpTqF1HDEobUktf8IR4CIA/exec", {
        method: "POST",
        body: formData,
      })
        .then((res) => res.text())
        .then((data) => {
          alert("✅ Formulario enviado: " + data);
          form.reset();
          document.getElementById("total_porcentaje").value = "";
        })
        .catch((error) => {
          alert("❌ Error al enviar el formulario");
          console.error(error);
        });
    });
  </script>
</body>
</html>
